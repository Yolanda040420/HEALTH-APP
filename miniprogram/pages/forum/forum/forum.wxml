<!-- pages/forum/forum/forum.wxml -->
<view class="page">

<!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
<view class="header">
  <text class="header-title">å¥åº·ç¤¾åŒº</text>
  <view class="header-actions">
    <text class="header-icon">â‹¯</text>
    <text class="header-icon">â—‹</text>
  </view>
</view>

<!-- é¡¶éƒ¨äºŒçº§ Tabï¼šè®ºå› / èµ„è®¯ -->
<view class="sub-tabs">
  <view class="sub-tab {{activeTab==='forum'?'active':''}}"
        data-tab="forum"
        bindtap="onSubTabTap">
    è®ºå›
  </view>
  <view class="sub-tab {{activeTab==='info'?'active':''}}"
        data-tab="info"
        bindtap="onSubTabTap">
    èµ„è®¯
  </view>
</view>

<!-- ================== è®ºå› Tab å†…å®¹ ================== -->
<block wx:if="{{activeTab==='forum'}}">
  <view class="forum-content">
    <!-- æœ€æ–°/çƒ­é—¨åˆ‡æ¢ -->
    <view class="sort-tabs">
      <text class="sort-icon">ğŸ””</text>
      <view class="sort-options">
        <text class="sort-option {{sortType==='latest'?'active':''}}" 
              data-type="latest"
              bindtap="onSortTap">æœ€æ–°</text>
        <text class="sort-divider">|</text>
        <text class="sort-option {{sortType==='hot'?'active':''}}" 
              data-type="hot"
              bindtap="onSortTap">çƒ­é—¨</text>
      </view>
    </view>

    <!-- å¸–å­åˆ—è¡¨ -->
    <scroll-view class="post-list" scroll-y="true">
      <block wx:for="{{posts}}" wx:key="id">
        <view class="post-card">
          <view class="post-header">
            <text class="post-author">{{item.author}}</text>
            <text class="post-time">{{item.time}}</text>
          </view>
          <view class="post-body">
            <view class="post-content">
              <text class="post-text">{{item.content}}</text>
            </view>
            <view class="post-images" wx:if="{{item.images && item.images.length > 0}}">
              <view class="post-images-left">
                <block wx:for="{{item.images}}" wx:key="*this" wx:for-item="img" wx:for-index="imgIdx">
                  <view wx:if="{{imgIdx < 4}}" class="post-image-small">
                    <image src="{{img}}" mode="aspectFill"></image>
                    <view wx:if="{{imgIdx === 3 && item.images.length > 4}}" class="image-more">+{{item.images.length - 4}}</view>
                  </view>
                </block>
              </view>
              <view class="post-image-large" wx:if="{{item.mainImage}}">
                <image src="{{item.mainImage}}" mode="aspectFill"></image>
              </view>
            </view>
          </view>
          <view class="post-footer">
            <view class="post-stats">
              <text class="stat-icon">ğŸ”¥</text>
              <text class="stat-value">{{item.hot}}</text>
              <text class="stat-icon">ğŸ‘</text>
              <text class="stat-value">{{item.likes}}</text>
              <text class="stat-icon">ğŸ’¬</text>
              <text class="stat-value">{{item.comments}}</text>
            </view>
          </view>
        </view>
      </block>
    </scroll-view>

    <!-- æ‚¬æµ®å‘å¸ƒæŒ‰é’® -->
    <view class="float-publish-btn" bindtap="onPublish">
      <text class="publish-icon">+</text>
    </view>
  </view>
</block>

<!-- ================== èµ„è®¯ Tab å†…å®¹ ================== -->
<block wx:elif="{{activeTab==='info'}}">
  <view class="info-content">
    <!-- èµ„è®¯æ–‡ç« åˆ—è¡¨ -->
    <scroll-view class="article-list" scroll-y="true">
      <block wx:for="{{articles}}" wx:key="id">
        <view class="article-card">
          <view class="article-header">
            <text class="article-title">{{item.title}}</text>
          </view>
          <view class="article-body">
            <text class="article-snippet">{{item.snippet}}</text>
            <view class="article-images" wx:if="{{item.images && item.images.length > 0}}">
              <block wx:for="{{item.images}}" wx:key="*this" wx:for-item="img" wx:for-index="imgIdx">
                <view wx:if="{{imgIdx < 3}}" class="article-image">
                  <image src="{{img}}" mode="aspectFill"></image>
                  <view wx:if="{{imgIdx === 2 && item.images.length > 3}}" class="image-more">+{{item.images.length - 3}}</view>
                </view>
              </block>
            </view>
          </view>
          <view class="article-footer">
            <view class="article-meta">
              <text class="meta-icon">ğŸ–¼ï¸</text>
              <text class="meta-value">{{item.imageCount}}</text>
              <text class="meta-icon">ğŸ•</text>
              <text class="meta-value">{{item.time}}</text>
            </view>
            <view class="article-comments">
              <text class="meta-icon">ğŸ’¬</text>
              <text class="meta-value">{{item.comments}}</text>
            </view>
          </view>
        </view>
      </block>
    </scroll-view>
  </view>
</block>

</view>
